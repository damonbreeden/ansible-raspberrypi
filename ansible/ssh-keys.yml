---
- hosts: all
  become: true
  vars:
    username: ubuntu
    keys_array:
      - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDUxf8lfKKcQ4kF1P+tV6SwsoFxSQKh00/3ksisOPceUlkloQ9Yis8XF6zhqzAKRs6JanDhJViRPBl2ZseBI5D6jx8yIC4tfy1aOOLIAoD3ByKUDUdaPiLMOCzsQOXJJvM6ljASTSompGSfvizWRBrkxL8N79vpPEqbV3RTgHhsZDJSnJeHQ9mOebXMVXljGdQViMlK+H3IAtEMZST7iAcnctih1iT+KmCwknazyHMp+kXhiMupL+XUt8FSsfNYP/xrSASBQzTJcKLGGSvUKFescCzRdT7E4yGbi0hT21mC6umgxAYzV0Zhi2vgqVthYvREeoH8U8q2sYvmqnBlD9zn damon@hp-9470m"
      - "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIK1EmdAnGW9Yi+9YGmSvYZHclrhho0wMYpKMUX/XUeDK Generated By Termius"
  tasks:
  - name: Set authorized key for user "{{ username }}" copying it from current user
    authorized_key:
      user: "{{ username }}"
      state: present
      key: "{{ lookup('file', lookup('env','HOME') + '/.ssh/id_rsa.pub') }}"
  - name: Set authorized key for user "{{ username }}" from keys_array
    authorized_key:
      user: "{{ username }}"
      state: present
      key: "{{ item }}"
    loop: "{{ keys_array }}"
